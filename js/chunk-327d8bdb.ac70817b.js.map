{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/layers/support/sublayerUtils.js","webpack:///./node_modules/@arcgis/core/layers/TileLayer.js","webpack:///./node_modules/@arcgis/core/layers/mixins/ArcGISMapService.js","webpack:///./node_modules/@arcgis/core/layers/support/Tilemap.js","webpack:///./node_modules/@arcgis/core/layers/support/TilemapCache.js","webpack:///./node_modules/@arcgis/core/layers/support/serviceTileInfoProperty.js","webpack:///./node_modules/@arcgis/core/layers/mixins/ArcGISCachedService.js","webpack:///./node_modules/@arcgis/core/layers/mixins/SublayersOwner.js","webpack:///./node_modules/@arcgis/core/layers/support/Sublayer.js"],"names":["e","n","i","flatten","sublayers","length","some","originIdOf","r","source","type","mapLayerId","id","gdbVersion","slice","reverse","toArray","map","o","t","minScale","layerDefinition","I","M","super","this","listMode","isReference","operationalLayerType","resampling","sourceJSON","spatialReference","path","url","signal","addResolvingPromise","loadFromPortal","supportedTypes","catch","then","_fetchService","Promise","resolve","parsedUrl","toLowerCase","_getDefaultAttribution","_getMapName","tileInfo","fromJSON","s","loaded","a","writeSublayerStructure","forEach","write","push","Object","keys","layers","_getDefaultTileServers","Array","isArray","timestamp","l","getTileUrl","responseType","query","_ts","data","tilemapCache","supportsBlankTile","blankTile","customParameters","token","apiKey","tileServers","bandCount","pixelSizeX","serverType","f","ssl","replace","read","origin","version","_fetchServerVersion","currentVersion","reject","match","indexOf","search","fetchTile","__isDefault__","readOnly","prototype","Boolean","json","enabled","overridePolicy","String","origins","C","y","m","arguments","capabilities","copyright","fullExtent","legendEnabled","split","trim","operations","supportsQuery","supportsExportMap","supportsExportTiles","supportsTileMap","exportMap","exportTiles","p","exportTilesAllowed","supportsDynamicLayers","u","c","cimVersion","parse","since","supportsArcadeExpressionForLabeling","supportsSublayersChanges","supportsSublayerVisibility","supportsSublayerDefinitionExpression","maxExportTilesCount","hasOwnProperty","fetchAllLayersAndTables","_allLayersAndTablesMap","get","load","_allLayersAndTablesPromise","Map","set","result","error","service","target","location","left","top","width","height","_allAvailability","byteSize","_tileAvailabilityBitSet","Math","ceil","Uint8Array","request","row","col","h","d","details","httpStatus","valid","response","definition","validateJSON","freeze","_updateFromData","level","w","T","getLogger","j","_handles","_pendingTilemapRequests","_availableLevels","levels","cacheByteSize","_prefetchingEnabled","_tilemapCache","add","watch","_initializeTilemapDefinition","_initializeAvailableLevels","destroy","_tmpTilemapDefinition","_tilemapFromCache","fromDefinition","put","getAvailability","layer","updateTileInfo","upsampleTile","fetchTilemap","fetchAvailability","fetchAvailabilityUpsample","_fetchAvailabilityUpsamplePrefetch","has","abort","remove","v","_prefetches","_maxPrefetch","removeUnordered","clear","size","hasTilemap","initialSize","constructOnly","Number","reader","maxScale","minLOD","maxLOD","ignoreMinMaxLOD","lods","filter","round","scale","b","parentLayerId","unshift","ofType","allSublayers","getCollections","getChildrenFunction","sublayersSourceJSON","2","3","4","5","handles","_handleSublayersChange","context","visibleLayers","_set","createSublayersForOrigin","setDefaultOrigin","find","S","Set","defaultVisibility","items","readSublayers","parent","on","item","preventDefault","value","allowNull","ignoreOrigin","V","k","A","_isOverridden","q","U","$","J","R","B","fields","globalIdField","objectIdField","popupEnabled","popupTemplate","title","typeIdField","types","sublayer","fetchSublayerInfo","supportsModification","canModifyLayer","_setAndNotifyLayer","name","_get","_logLockedError","drawingInfo","labelingInfo","transparency","createPopupTemplate","getSymbols","warn","_lastParsedUrl","JSON","stringify","_override","_clearOverride","getAtOrigin","store","clone","commitProperty","returnGeometry","where","definitionExpression","default","layerId","dynamicDataSource","refreshInterval","labelsVisible","visible","opacity","renderer","attributes","toString","feature","getFeatureType","domains","_getLayerDomain","createQuery","executeQuery","all","from","features","sourceLayer","toJSON","reduce","showLabels","_assignDefaultSymbolColors","_forEachSimpleMarkerSymbols","color","style","outline","uniqueValueInfos","classBreakInfos","symbol","defaultSymbol","getDefaultOrigin","loadStatus","emit","propertyName","removeAll","reason","fieldsIndex","domain","test","isMapImageLayerOverridePolicy","isTileImageLayerOverridePolicy","disablePopup","key","base","typeMap","Q"],"mappings":"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","file":"js/chunk-327d8bdb.ac70817b.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nfunction e(e,n,i){if(n.flatten((({sublayers:e})=>e)).length!==e.length)return!0;return!!e.some((e=>e.originIdOf(\"minScale\")>i||e.originIdOf(\"maxScale\")>i||e.originIdOf(\"renderer\")>i||e.originIdOf(\"labelingInfo\")>i||e.originIdOf(\"opacity\")>i||e.originIdOf(\"labelsVisible\")>i||e.originIdOf(\"source\")>i))||!r(e,n)}function n(e,n,i){return!!e.some((e=>{const n=e.source;return!(!n||\"map-layer\"===n.type&&n.mapLayerId===e.id&&(!n.gdbVersion||n.gdbVersion===i.gdbVersion))||e.originIdOf(\"renderer\")>2||e.originIdOf(\"labelingInfo\")>2||e.originIdOf(\"opacity\")>2||e.originIdOf(\"labelsVisible\")>2}))||!r(e,n)}function r(e,n){if(!e||!e.length)return!0;const r=n.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).map((e=>e.id)).toArray();if(e.length>r.length)return!1;let i=0;const o=r.length;for(const{id:t}of e){for(;i<o&&r[i]!==t;)i++;if(i>=o)return!1}return!0}function i(e){return!!e&&e.some((e=>null!=e.minScale||e.layerDefinition&&null!=e.layerDefinition.minScale))}export{n as isExportDynamic,i as isSublayerOverhaul,e as shouldWriteSublayerStructure};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import\"../geometry.js\";import r from\"../request.js\";import t from\"../core/Error.js\";import{HandleOwnerMixin as s}from\"../core/HandleOwner.js\";import{isSome as i}from\"../core/maybe.js\";import{MultiOriginJSONMixin as o}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAbortError as a}from\"../core/promiseUtils.js\";import{urlToObject as l,objectToQuery as n,makeAbsolute as p}from\"../core/urlUtils.js\";import{property as c}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import{cast as u}from\"../core/accessorSupport/decorators/cast.js\";import\"../core/Logger.js\";import{reader as m}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as h}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as d}from\"../core/accessorSupport/decorators/writer.js\";import y from\"./Layer.js\";import{APIKeyMixin as f}from\"./mixins/APIKeyMixin.js\";import{ArcGISCachedService as v}from\"./mixins/ArcGISCachedService.js\";import{ArcGISMapService as g}from\"./mixins/ArcGISMapService.js\";import{ArcGISService as _}from\"./mixins/ArcGISService.js\";import{BlendLayer as S}from\"./mixins/BlendLayer.js\";import{CustomParametersMixin as j}from\"./mixins/CustomParametersMixin.js\";import{OperationalLayer as b}from\"./mixins/OperationalLayer.js\";import{PortalLayer as T}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as w}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as O}from\"./mixins/ScaleRangeLayer.js\";import{SublayersOwner as L}from\"./mixins/SublayersOwner.js\";import{parse as R,isHostedAgolService as x,isArcGISUrl as U}from\"./support/arcgisLayerUrl.js\";import{url as P}from\"./support/commonProperties.js\";import A from\"./support/Sublayer.js\";import W from\"../geometry/SpatialReference.js\";const I=[\"Canvas/World_Dark_Gray_Base\",\"Canvas/World_Dark_Gray_Reference\",\"Canvas/World_Light_Gray_Base\",\"Canvas/World_Light_Gray_Reference\",\"Elevation/World_Hillshade\",\"Elevation/World_Hillshade_Dark\",\"Ocean/World_Ocean_Base\",\"Ocean/World_Ocean_Reference\",\"Ocean_Basemap\",\"Reference/World_Boundaries_and_Places\",\"Reference/World_Boundaries_and_Places_Alternate\",\"Reference/World_Transportation\",\"World_Imagery\",\"World_Street_Map\",\"World_Topo_Map\"];let M=class extends(S(L(O(w(b(T(v(g(_(o(s(f(j(y)))))))))))))){constructor(...e){super(...e),this.listMode=\"show\",this.isReference=null,this.operationalLayerType=\"ArcGISTiledMapServiceLayer\",this.resampling=!0,this.sourceJSON=null,this.spatialReference=null,this.path=null,this.sublayers=null,this.type=\"tile\",this.url=null}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}load(e){const r=i(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Map Service\"]},e).catch(a).then((()=>this._fetchService(r)))),Promise.resolve(this)}get attributionDataUrl(){var e;const r=null==(e=this.parsedUrl)?void 0:e.path.toLowerCase();return r&&this._getDefaultAttribution(this._getMapName(r))}readSpatialReference(e,r){return(e=e||r.tileInfo&&r.tileInfo.spatialReference)&&W.fromJSON(e)}writeSublayers(e,r,t,s){if(!this.loaded||!e)return;const i=e.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).toArray(),o=[],a={writeSublayerStructure:!1,...s};i.forEach((e=>{const r=e.write({},a);o.push(r)}));o.some((e=>Object.keys(e).length>1))&&(r.layers=o)}get tileServers(){return this._getDefaultTileServers(this.parsedUrl.path)}castTileServers(e){return Array.isArray(e)?e.map((e=>l(e).path)):null}fetchTile(e,t,s,i={}){const{signal:o,timestamp:a}=i,l=this.getTileUrl(e,t,s),n={responseType:\"image\",signal:o};return null!=a&&(n.query={_ts:i.timestamp}),r(l,n).then((e=>e.data))}getTileUrl(e,r,t){const s=!this.tilemapCache&&this.supportsBlankTile,i=n({...this.parsedUrl.query,blankTile:!s&&null,...this.customParameters,token:this.apiKey}),o=this.tileServers;return`${o&&o.length?o[r%o.length]:this.parsedUrl.path}/tile/${e}/${r}/${t}${i?\"?\"+i:\"\"}`}_fetchService(e){return new Promise(((s,o)=>{if(this.sourceJSON){if(null!=this.sourceJSON.bandCount&&null!=this.sourceJSON.pixelSizeX)throw new t(\"tile-layer:unsupported-url\",\"use ImageryTileLayer to open a tiled image service\");return void s({data:this.sourceJSON})}if(!this.parsedUrl)throw new t(\"tile-layer:undefined-url\",\"layer's url is not defined\");const a=R(this.parsedUrl.path);if(i(a)&&\"ImageServer\"===a.serverType)throw new t(\"tile-layer:unsupported-url\",\"use ImageryTileLayer to open a tiled image service\");r(this.parsedUrl.path,{query:{f:\"json\",...this.parsedUrl.query,...this.customParameters,token:this.apiKey},responseType:\"json\",signal:e}).then(s,o)})).then((r=>{if(r.ssl&&(this.url=this.url.replace(/^http:/i,\"https:\")),this.sourceJSON=r.data,this.read(r.data,{origin:\"service\",url:this.parsedUrl}),10.1===this.version&&!x(this.url))return this._fetchServerVersion(this.url,e).then((e=>{this.read({currentVersion:e})})).catch((()=>{}))}))}_fetchServerVersion(e,s){if(!U(e))return Promise.reject();const i=e.replace(/(.*\\/rest)\\/.*/i,\"$1\")+\"/info\";return r(i,{query:{f:\"json\",...this.customParameters,token:this.apiKey},responseType:\"json\",signal:s}).then((e=>{if(e.data&&e.data.currentVersion)return e.data.currentVersion;throw new t(\"tile-layer:version-not-available\")}))}_getMapName(e){const r=e.match(/^(?:https?:)?\\/\\/(server\\.arcgisonline\\.com|services\\.arcgisonline\\.com|ibasemaps-api\\.arcgis\\.com)\\/arcgis\\/rest\\/services\\/([^\\/]+(\\/[^\\/]+)*)\\/mapserver/i);return r&&r[2]}_getDefaultAttribution(e){if(!e)return;let r;e=e.toLowerCase();for(let t=0,s=I.length;t<s;t++)if(r=I[t],r.toLowerCase().indexOf(e)>-1)return p(\"//static.arcgis.com/attribution/\"+r)}_getDefaultTileServers(e){const r=-1!==e.search(/^(?:https?:)?\\/\\/server\\.arcgisonline\\.com/i),t=-1!==e.search(/^(?:https?:)?\\/\\/services\\.arcgisonline\\.com/i);return r||t?[e,e.replace(r?/server\\.arcgisonline/i:/services\\.arcgisonline/i,r?\"services.arcgisonline\":\"server.arcgisonline\")]:[]}get hasOverriddenFetchTile(){return!this.fetchTile.__isDefault__}};e([c({readOnly:!0})],M.prototype,\"attributionDataUrl\",null),e([c({type:[\"show\",\"hide\",\"hide-children\"]})],M.prototype,\"listMode\",void 0),e([c({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],M.prototype,\"isReference\",void 0),e([c({readOnly:!0,type:[\"ArcGISTiledMapServiceLayer\"]})],M.prototype,\"operationalLayerType\",void 0),e([c({type:Boolean})],M.prototype,\"resampling\",void 0),e([c()],M.prototype,\"sourceJSON\",void 0),e([c({type:W})],M.prototype,\"spatialReference\",void 0),e([m(\"spatialReference\",[\"spatialReference\",\"tileInfo\"])],M.prototype,\"readSpatialReference\",null),e([c({type:String,json:{origins:{\"web-scene\":{read:!0,write:!0}},read:!1}})],M.prototype,\"path\",void 0),e([c({readOnly:!0})],M.prototype,\"sublayers\",void 0),e([d(\"sublayers\",{layers:{type:[A]}})],M.prototype,\"writeSublayers\",null),e([c({json:{read:!1,write:!1}})],M.prototype,\"popupEnabled\",void 0),e([c()],M.prototype,\"tileServers\",null),e([u(\"tileServers\")],M.prototype,\"castTileServers\",null),e([c({readOnly:!0,json:{read:!1}})],M.prototype,\"type\",void 0),e([c(P)],M.prototype,\"url\",void 0),M=e([h(\"esri.layers.TileLayer\")],M),M.prototype.fetchTile.__isDefault__=!0;var C=M;export default C;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../request.js\";import{throwIfAborted as s}from\"../../core/promiseUtils.js\";import{urlToObject as t}from\"../../core/urlUtils.js\";import{Version as o}from\"../../core/Version.js\";import{property as i}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{reader as p}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import l from\"../../geometry/Extent.js\";import n from\"../../geometry/SpatialReference.js\";import{id as u,popupEnabled as c}from\"../support/commonProperties.js\";const y=y=>{let m=class extends y{constructor(){super(...arguments),this.capabilities=void 0,this.copyright=null,this.fullExtent=null,this.legendEnabled=!0,this.spatialReference=null,this.version=null}readCapabilities(e,r){const s=r.capabilities&&r.capabilities.split(\",\").map((e=>e.toLowerCase().trim()));if(!s)return{operations:{supportsQuery:!1,supportsExportMap:!1,supportsExportTiles:!1,supportsTileMap:!1},exportMap:null,exportTiles:null};const t=this.type,i=-1!==s.indexOf(\"query\"),p=-1!==s.indexOf(\"map\"),a=!!r.exportTilesAllowed,l=-1!==s.indexOf(\"tilemap\"),n=\"tile\"!==t&&!!r.supportsDynamicLayers,u=\"tile\"!==t&&(!r.tileInfo||n),c=\"tile\"!==t&&(!r.tileInfo||n),y=\"tile\"!==t,m=!!r.cimVersion&&o.parse(r.cimVersion).since(1,4);return{operations:{supportsQuery:i,supportsExportMap:p,supportsExportTiles:a,supportsTileMap:l},exportMap:p?{supportsArcadeExpressionForLabeling:m,supportsSublayersChanges:y,supportsDynamicLayers:n,supportsSublayerVisibility:u,supportsSublayerDefinitionExpression:c}:null,exportTiles:a?{maxExportTilesCount:+r.maxExportTilesCount}:null}}readVersion(e,r){let s=r.currentVersion;return s||(s=r.hasOwnProperty(\"capabilities\")||r.hasOwnProperty(\"tables\")?10:r.hasOwnProperty(\"supportedImageFormatTypes\")?9.31:9.3),s}async fetchSublayerInfo(e,r){return await this.fetchAllLayersAndTables(r),this._allLayersAndTablesMap.get(e)}async fetchAllLayersAndTables(e){await this.load(e),this._allLayersAndTablesPromise||(this._allLayersAndTablesPromise=r(t(this.url).path+\"/layers\",{responseType:\"json\",query:{f:\"json\",...this.customParameters,token:this.apiKey}}).then((e=>{this._allLayersAndTablesMap=new Map;for(const r of e.data.layers)this._allLayersAndTablesMap.set(r.id,r);return{result:e.data}}),(e=>({error:e}))));const o=await this._allLayersAndTablesPromise;if(s(e),\"result\"in o)return o.result;throw o.error}};return e([i({readOnly:!0})],m.prototype,\"capabilities\",void 0),e([p(\"service\",\"capabilities\",[\"capabilities\",\"exportTilesAllowed\",\"maxExportTilesCount\",\"supportsDynamicLayers\",\"tileInfo\"])],m.prototype,\"readCapabilities\",null),e([i({json:{read:{source:\"copyrightText\"}}})],m.prototype,\"copyright\",void 0),e([i({type:l})],m.prototype,\"fullExtent\",void 0),e([i(u)],m.prototype,\"id\",void 0),e([i({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:\"showLegend\"},write:{target:\"showLegend\"}}})],m.prototype,\"legendEnabled\",void 0),e([i(c)],m.prototype,\"popupEnabled\",void 0),e([i({type:n})],m.prototype,\"spatialReference\",void 0),e([i()],m.prototype,\"version\",void 0),e([p(\"version\",[\"currentVersion\",\"capabilities\",\"tables\",\"supportedImageFormatTypes\"])],m.prototype,\"readVersion\",null),m=e([a(\"esri.layers.mixins.ArcGISMapService\")],m),m};export{y as ArcGISMapService};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from\"../../request.js\";import{constant as i}from\"../../core/arrayUtils.js\";import e from\"../../core/Error.js\";import{clone as a}from\"../../core/lang.js\";class l{constructor(){this.location={left:0,top:0,width:0,height:0},this._allAvailability=\"unknown\",this.byteSize=40}getAvailability(t,i){if(\"unknown\"!==this._allAvailability)return this._allAvailability;const e=(t-this.location.top)*this.location.width+(i-this.location.left),a=e%8,l=e>>3,o=this._tileAvailabilityBitSet;return l<0||l>o.length?\"unknown\":o[l]&1<<a?\"available\":\"unavailable\"}_updateFromData(t){const i=this.location.width,e=this.location.height;let a=!0,l=!0;const o=Math.ceil(i*e/8),n=new Uint8Array(o);let r=0;for(let s=0;s<t.length;s++){const i=s%8;t[s]?(l=!1,n[r]|=1<<i):a=!1,7===i&&++r}l?this._allAvailability=\"unavailable\":a?this._allAvailability=\"available\":(this._allAvailability=\"unknown\",this._tileAvailabilityBitSet=n,this.byteSize+=n.length)}static fromDefinition(a,o){const r=a.service.request||t,{row:s,col:h,width:c,height:m}=a,d={query:{f:\"json\"}};return o=o?{...d,...o}:d,r(n(a),o).then((t=>t.data)).catch((t=>{if(t&&t.details&&422===t.details.httpStatus)return{location:{top:s,left:h,width:c,height:m},valid:!0,data:i(c*m,0)};throw t})).then((t=>{if(t.location&&(t.location.top!==s||t.location.left!==h||t.location.width!==c||t.location.height!==m))throw new e(\"tilemap:location-mismatch\",\"Tilemap response for different location than requested\",{response:t,definition:{top:s,left:h,width:c,height:m}});return l.fromJSON(t)}))}static fromJSON(t){l.validateJSON(t);const i=new l;return i.location=Object.freeze(a(t.location)),i._updateFromData(t.data),Object.freeze(i)}static validateJSON(t){if(!t||!t.location)throw new e(\"tilemap:missing-location\",\"Location missing from tilemap response\");if(!1===t.valid)throw new e(\"tilemap:invalid\",\"Tilemap response was marked as invalid\");if(!t.data)throw new e(\"tilemap:missing-data\",\"Data missing from tilemap response\");if(!Array.isArray(t.data))throw new e(\"tilemap:data-mismatch\",\"Data must be an array of numbers\");if(t.data.length!==t.location.width*t.location.height)throw new e(\"tilemap:data-mismatch\",\"Number of data items does not match width/height of tilemap\")}}function o(t){return`${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}function n(t){let i;if(\"vector-tile\"===t.service.type)i=`${t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`;else{const e=t.service.tileServers;i=`${e&&e.length?e[t.row%e.length]:t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}const e=t.service.query;return e&&(i=`${i}?${e}`),i}export default l;export{l as Tilemap,o as tilemapDefinitionId};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../request.js\";import i from\"../../core/Accessor.js\";import l from\"../../core/Error.js\";import r from\"../../core/Handles.js\";import s from\"../../core/Logger.js\";import a from\"../../core/LRUCache.js\";import o from\"../../core/PooledArray.js\";import{onAbort as n,createAbortError as c,isAbortError as h,createAbortController as p,isAborted as m}from\"../../core/promiseUtils.js\";import{waitTicks as u}from\"../../core/scheduling.js\";import{objectToQuery as f}from\"../../core/urlUtils.js\";import{init as v}from\"../../core/watchUtils.js\";import{property as y}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import{cast as _}from\"../../core/accessorSupport/decorators/cast.js\";import{subclass as d}from\"../../core/accessorSupport/decorators/subclass.js\";import{tilemapDefinitionId as b,Tilemap as g}from\"./Tilemap.js\";var w;const T=s.getLogger(\"esri.layers.support.TilemapCache\");let j=w=class extends i{constructor(e){super(e),this._handles=new r,this._pendingTilemapRequests={},this._availableLevels={},this.levels=5,this.cacheByteSize=2097152,this.request=t,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new a(this.cacheByteSize),this._handles.add([this.watch([\"layer.parsedUrl\",\"layer.tileServers?\"],(()=>this._initializeTilemapDefinition())),v(this,\"layer.tileInfo.lods\",(e=>this._initializeAvailableLevels(e)),!0)]),this._initializeTilemapDefinition()}destroy(){this._handles&&(this._handles.destroy(),this._handles=null)}castLevels(e){return e<=2?(T.error(\"Minimum levels for Tilemap is 3, but got \",e),3):e}get size(){return 1<<this.levels}fetchTilemap(e,t,i,r){if(!this._availableLevels[e])return Promise.reject(new l(\"tilemap-cache:level-unavailable\",`Level ${e} is unavailable in the service`));const s=this._tmpTilemapDefinition,a=this._tilemapFromCache(e,t,i,s);if(a)return Promise.resolve(a);const o=r&&r.signal;return r={...r,signal:null},new Promise(((e,t)=>{n(o,(()=>t(c())));const i=b(s);let l=this._pendingTilemapRequests[i];if(!l){l=g.fromDefinition(s,r).then((e=>(this._tilemapCache.put(i,e,e.byteSize),e)));const e=()=>delete this._pendingTilemapRequests[i];this._pendingTilemapRequests[i]=l,l.then(e,e)}l.then(e,t)}))}getAvailability(e,t,i){if(!this._availableLevels[e])return\"unavailable\";const l=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return l?l.getAvailability(t,i):\"unknown\"}getAvailabilityUpsample(e,t,i,l){l.level=e,l.row=t,l.col=i;const r=this.layer.tileInfo;for(r.updateTileInfo(l);;){const e=this.getAvailability(l.level,l.row,l.col);if(\"unavailable\"!==e)return e;if(!r.upsampleTile(l))return\"unavailable\"}}fetchAvailability(e,t,i,r){return this._availableLevels[e]?this.fetchTilemap(e,t,i,r).catch((e=>e)).then((r=>{if(r instanceof g){const s=r.getAvailability(t,i);return\"unavailable\"===s?Promise.reject(new l(\"tile-map:tile-unavailable\",\"Tile is not available\",{level:e,row:t,col:i})):s}if(h(r))throw r;return\"unknown\"})):Promise.reject(new l(\"tilemap-cache:level-unavailable\",`Level ${e} is unavailable in the service`))}fetchAvailabilityUpsample(e,t,i,l,r){l.level=e,l.row=t,l.col=i;const s=this.layer.tileInfo;s.updateTileInfo(l);const a=this.fetchAvailability(e,t,i,r).catch((e=>{if(h(e))throw e;if(s.upsampleTile(l))return this.fetchAvailabilityUpsample(l.level,l.row,l.col,l);throw e}));return this._fetchAvailabilityUpsamplePrefetch(l.id,e,t,i,r,a),a}async _fetchAvailabilityUpsamplePrefetch(e,t,i,l,r,s){if(!this._prefetchingEnabled)return;const a=`prefetch-${e}`;if(this._handles.has(a))return;const o=p();s.then((()=>o.abort()),(()=>o.abort()));let n=!1;const c={remove(){n||(n=!0,o.abort())}};if(this._handles.add(c,a),await u(10,o.signal).catch((()=>{})),n||(n=!0,this._handles.remove(a)),m(o))return;const h={id:e,level:t,row:i,col:l},f={...r,signal:o.signal},v=this.layer.tileInfo;for(let p=0;w._prefetches.length<w._maxPrefetch&&v.upsampleTile(h);++p){const e=this.fetchAvailability(h.level,h.row,h.col,f);w._prefetches.push(e);const t=()=>{w._prefetches.removeUnordered(e)};e.then(t,t)}}_initializeTilemapDefinition(){if(!this.layer.parsedUrl)return;const e=this.layer.parsedUrl,t=e.query;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:t?f(t):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(e,t,i,l){l.level=e,l.row=t-t%this.size,l.col=i-i%this.size;const r=b(l);return this._tilemapCache.get(r)}_initializeAvailableLevels(e){this._availableLevels={},e&&e.forEach((e=>this._availableLevels[e.level]=!0))}get test(){const e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:(t,i,l)=>!!e._tilemapFromCache(t,i,l,e._tmpTilemapDefinition)}}};j._maxPrefetch=4,j._prefetches=new o({initialSize:w._maxPrefetch}),e([y({constructOnly:!0,type:Number})],j.prototype,\"levels\",void 0),e([_(\"levels\")],j.prototype,\"castLevels\",null),e([y({readOnly:!0,type:Number})],j.prototype,\"size\",null),e([y({constructOnly:!0,type:Number})],j.prototype,\"cacheByteSize\",void 0),e([y({constructOnly:!0})],j.prototype,\"layer\",void 0),e([y({constructOnly:!0})],j.prototype,\"request\",void 0),j=w=e([d(\"esri.layers.support.TilemapCache\")],j);export{j as TilemapCache};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"./TileInfo.js\";const r={type:e,json:{origins:{service:{read:{source:[\"tileInfo\",\"minScale\",\"maxScale\",\"minLOD\",\"maxLOD\"],reader:n}}}}};function n(r,n,l,o){if(!r)return null;const{minScale:i,maxScale:t,minLOD:m,maxLOD:s}=n;if(null!=m&&null!=s)return o&&o.ignoreMinMaxLOD?e.fromJSON(r):e.fromJSON({...r,lods:r.lods.filter((({level:e})=>null!=e&&e>=m&&e<=s))});if(0!==i&&0!==t){const n=e=>Math.round(1e4*e)/1e4,l=i?n(i):1/0,o=t?n(t):-1/0;return e.fromJSON({...r,lods:r.lods.filter((e=>{const r=n(e.scale);return r<=l&&r>=o}))})}return e.fromJSON(r)}export{n as readServiceTileInfo,r as serviceTileInfoProperty};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{reader as o}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import{serviceTileInfoProperty as i}from\"../support/serviceTileInfoProperty.js\";import{TilemapCache as p}from\"../support/TilemapCache.js\";import a from\"../../geometry/SpatialReference.js\";const s=s=>{let l=class extends s{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}readMinScale(e,r){return null!=r.minLOD&&null!=r.maxLOD?e:0}readMaxScale(e,r){return null!=r.minLOD&&null!=r.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,r){return r.capabilities&&r.capabilities.indexOf(\"Tilemap\")>-1?new p({layer:this}):null}};return e([r({json:{read:{source:\"copyrightText\"}}})],l.prototype,\"copyright\",void 0),e([r()],l.prototype,\"minScale\",void 0),e([o(\"service\",\"minScale\")],l.prototype,\"readMinScale\",null),e([r()],l.prototype,\"maxScale\",void 0),e([o(\"service\",\"maxScale\")],l.prototype,\"readMaxScale\",null),e([r({type:a})],l.prototype,\"spatialReference\",void 0),e([r({readOnly:!0})],l.prototype,\"supportsBlankTile\",null),e([r(i)],l.prototype,\"tileInfo\",void 0),e([r()],l.prototype,\"tilemapCache\",void 0),e([o(\"service\",\"tilemapCache\",[\"capabilities\"])],l.prototype,\"readTilemapCache\",null),e([r()],l.prototype,\"version\",void 0),l=e([t(\"esri.layers.mixins.ArcGISCachedService\")],l),l};export{s as ArcGISCachedService};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Collection.js\";import s from\"../../core/CollectionFlattener.js\";import t from\"../../core/Error.js\";import o from\"../../core/Logger.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import{getProperties as l}from\"../../core/accessorSupport/utils.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as i}from\"../../core/accessorSupport/decorators/subclass.js\";import{nameToId as n,idToName as u}from\"../../core/accessorSupport/PropertyOrigin.js\";import y from\"../support/Sublayer.js\";import{isSublayerOverhaul as c}from\"../support/sublayerUtils.js\";const b=o.getLogger(\"esri.layers.TileLayer\");function p(e,r){const s=[],t={};return e?(e.forEach((e=>{const o=new y;if(o.read(e,r),t[o.id]=o,null!=e.parentLayerId&&-1!==e.parentLayerId){const r=t[e.parentLayerId];r.sublayers||(r.sublayers=[]),r.sublayers.unshift(o)}else s.unshift(o)})),s):s}const d=r.ofType(y);function h(e,r){e&&e.forEach((e=>{r(e),e.sublayers&&e.sublayers.length&&h(e.sublayers,r)}))}const f=o=>{let f=class extends o{constructor(...e){super(...e),this.allSublayers=new s({getCollections:()=>[this.sublayers],getChildrenFunction:e=>e.sublayers}),this.sublayersSourceJSON={2:{},3:{},4:{},5:{}},this.handles.add(this.watch(\"sublayers\",((e,r)=>this._handleSublayersChange(e,r)),!0))}readSublayers(e,r){if(!r||!e)return;const{sublayersSourceJSON:s}=this,t=n(r.origin);if(t<2)return;if(s[t]={context:r,visibleLayers:e.visibleLayers||s[t].visibleLayers,layers:e.layers||s[t].layers},t>2)return;this._set(\"serviceSublayers\",this.createSublayersForOrigin(\"service\").sublayers);const{sublayers:o,origin:a}=this.createSublayersForOrigin(\"web-document\"),i=l(this);i.setDefaultOrigin(a),this._set(\"sublayers\",new d(o)),i.setDefaultOrigin(\"user\")}findSublayerById(e){return this.allSublayers.find((r=>r.id===e))}createServiceSublayers(){return this.createSublayersForOrigin(\"service\").sublayers}createSublayersForOrigin(e){const r=n(\"web-document\"===e?\"web-map\":e);let s=2,t=this.sublayersSourceJSON[2].layers,o=this.sublayersSourceJSON[2].context,a=null;const l=[3,4,5].filter((e=>e<=r));for(const n of l){const e=this.sublayersSourceJSON[n];c(e.layers)&&(s=n,t=e.layers,o=e.context,e.visibleLayers&&(a={visibleLayers:e.visibleLayers,context:e.context}))}const i=[3,4,5].filter((e=>e>s&&e<=r));let y=null;for(const n of i){const{layers:e,visibleLayers:r,context:s}=this.sublayersSourceJSON[n];e&&(y={layers:e,context:s}),r&&(a={visibleLayers:r,context:s})}const b=p(t,o),f=new Map,S=new Set;if(y)for(const n of y.layers)f.set(n.id,n);if(a)for(const n of a.visibleLayers)S.add(n);return h(b,(e=>{y&&e.read(f.get(e.id),y.context),a&&e.read({defaultVisibility:S.has(e.id)},a.context)})),{origin:u(s),sublayers:new d({items:b})}}read(e,r){super.read(e,r),this.readSublayers(e,r)}_handleSublayersChange(e,r){r&&(r.forEach((e=>{e.parent=null,e.layer=null})),this.handles.remove(\"sublayers-owner\")),e&&(e.forEach((e=>{e.parent=this,e.layer=this})),this.handles.add([e.on(\"after-add\",(({item:e})=>{e.parent=this,e.layer=this})),e.on(\"after-remove\",(({item:e})=>{e.parent=null,e.layer=null}))],\"sublayers-owner\"),\"tile\"===this.type&&this.handles.add(e.on(\"before-changes\",(e=>{b.error(new t(\"tilelayer:sublayers-non-modifiable\",\"ISublayer can't be added, moved, or removed from the layer's sublayers\",{layer:this})),e.preventDefault()})),\"sublayers-owner\"))}};return e([a({readOnly:!0})],f.prototype,\"allSublayers\",void 0),e([a({readOnly:!0,type:r.ofType(y)})],f.prototype,\"serviceSublayers\",void 0),e([a({value:null,type:d,json:{read:!1,write:{allowNull:!0,ignoreOrigin:!0}}})],f.prototype,\"sublayers\",void 0),e([a({readOnly:!0})],f.prototype,\"sublayersSourceJSON\",void 0),f=e([i(\"esri.layers.mixins.SublayersOwner\")],f),f};export{f as SublayersOwner,h as forEachSublayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import r from\"../../PopupTemplate.js\";import\"../../renderers/ClassBreaksRenderer.js\";import\"../../renderers/DictionaryRenderer.js\";import\"../../renderers/DotDensityRenderer.js\";import\"../../renderers/HeatmapRenderer.js\";import\"../../renderers/Renderer.js\";import\"../../renderers/SimpleRenderer.js\";import\"../../renderers/UniqueValueRenderer.js\";import\"../../renderers/support/jsonUtils.js\";import{rendererTypes as i,webSceneRendererTypes as t}from\"../../renderers/support/types.js\";import o from\"../../request.js\";import{isSymbol3D as s}from\"../../symbols.js\";import a from\"../../core/Collection.js\";import l from\"../../core/Error.js\";import{HandleOwnerMixin as n}from\"../../core/HandleOwner.js\";import{IdentifiableMixin as p}from\"../../core/Identifiable.js\";import{clone as y}from\"../../core/lang.js\";import d from\"../../core/Loadable.js\";import u from\"../../core/Logger.js\";import{MultiOriginJSONMixin as c}from\"../../core/MultiOriginJSONSupport.js\";import{objectToQuery as f}from\"../../core/urlUtils.js\";import{property as m}from\"../../core/accessorSupport/decorators/property.js\";import{getProperties as h}from\"../../core/accessorSupport/utils.js\";import{cast as b}from\"../../core/accessorSupport/decorators/cast.js\";import\"../../core/has.js\";import{reader as g}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as v}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as S}from\"../../core/accessorSupport/decorators/writer.js\";import{ensureInteger as I,ensureType as w,Integer as j,ensureClass as L}from\"../../core/accessorSupport/ensureType.js\";import{nameToId as D}from\"../../core/accessorSupport/PropertyOrigin.js\";import O from\"./FeatureType.js\";import x from\"./Field.js\";import P from\"./FieldsIndex.js\";import F from\"./LabelClass.js\";import{DataLayerSource as _}from\"./source/DataLayerSource.js\";import{MapLayerSource as E}from\"./source/MapLayerSource.js\";import M from\"../../rest/support/Query.js\";import{createPopupTemplate as N}from\"../../support/popupUtils.js\";import T from\"../../geometry/Extent.js\";var V;function k(e){return e&&\"esriSMS\"===e.type}function C(e,r,i){var t;const o=this.originIdOf(r)>=D(i.origin);return{ignoreOrigin:!0,allowNull:o,enabled:!!i&&(\"map-image\"===(null==(t=i.layer)?void 0:t.type)&&(i.writeSublayerStructure||o))}}function A(e,r,i){var t;return{enabled:!!i&&(\"tile\"===(null==(t=i.layer)?void 0:t.type)&&this._isOverridden(r))}}function q(e,r,i){return{ignoreOrigin:!0,enabled:i&&i.writeSublayerStructure||!1}}function U(e,r,i){return{ignoreOrigin:!0,enabled:!!i&&(i.writeSublayerStructure||this.originIdOf(r)>=D(i.origin))}}const $=u.getLogger(\"esri.layers.support.Sublayer\");let J=0;const R=new Set;R.add(\"layer\"),R.add(\"parent\"),R.add(\"loaded\"),R.add(\"loadStatus\"),R.add(\"loadError\"),R.add(\"loadWarnings\");let B=V=class extends(n(c(p(d)))){constructor(e){super(e),this.capabilities=void 0,this.fields=null,this.fullExtent=null,this.globalIdField=null,this.legendEnabled=!0,this.objectIdField=null,this.popupEnabled=!0,this.popupTemplate=null,this.sourceJSON=null,this.title=null,this.typeIdField=null,this.types=null}async load(e){return this.addResolvingPromise((async()=>{var r;if(!this.layer&&!this.url)throw new l(\"sublayer:missing-layer\",\"Sublayer can't be loaded without being part of a layer\",{sublayer:this});let i=null;if(!this.layer||this.originIdOf(\"url\")>2||\"data-layer\"===(null==(r=this.source)?void 0:r.type)){i=(await o(this.url,{responseType:\"json\",query:{f:\"json\"},...e})).data}else{var t;let r=this.id;\"map-layer\"===(null==(t=this.source)?void 0:t.type)&&(r=this.source.mapLayerId),i=await this.layer.fetchSublayerInfo(r,e)}i&&(this.sourceJSON=i,this.read({layerDefinition:i},{origin:\"service\"}))})()),this}readCapabilities(e,r){const i=(e=(r=r.layerDefinition||r).capabilities||e)?e.toLowerCase().split(\",\").map((e=>e.trim())):[];return{exportMap:{supportsModification:!!r.canModifyLayer},operations:{supportsQuery:-1!==i.indexOf(\"query\")}}}set definitionExpression(e){this._setAndNotifyLayer(\"definitionExpression\",e)}get fieldsIndex(){return new P(this.fields||[])}readGlobalIdFieldFromService(e,r){if((r=r.layerDefinition||r).globalIdField)return r.globalIdField;if(r.fields)for(const i of r.fields)if(\"esriFieldTypeGlobalID\"===i.type)return i.name}get id(){const e=this._get(\"id\");return null==e?J++:e}set id(e){this._get(\"id\")!==e&&(!1!==this.get(\"layer.capabilities.exportMap.supportsDynamicLayers\")?this._set(\"id\",e):this._logLockedError(\"id\",\"capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'\"))}set labelingInfo(e){this._setAndNotifyLayer(\"labelingInfo\",e)}writeLabelingInfo(e,r,i,t){e&&e.length&&(r.layerDefinition={drawingInfo:{labelingInfo:e.map((e=>e.write({},t)))}})}set labelsVisible(e){this._setAndNotifyLayer(\"labelsVisible\",e)}set layer(e){this._set(\"layer\",e),this.sublayers&&this.sublayers.forEach((r=>r.layer=e))}set listMode(e){this._set(\"listMode\",e)}set minScale(e){this._setAndNotifyLayer(\"minScale\",e)}readMinScale(e,r){return r.minScale||r.layerDefinition&&r.layerDefinition.minScale||0}set maxScale(e){this._setAndNotifyLayer(\"maxScale\",e)}readMaxScale(e,r){return r.maxScale||r.layerDefinition&&r.layerDefinition.maxScale||0}readObjectIdFieldFromService(e,r){if((r=r.layerDefinition||r).objectIdField)return r.objectIdField;if(r.fields)for(const i of r.fields)if(\"esriFieldTypeOID\"===i.type)return i.name}set opacity(e){this._setAndNotifyLayer(\"opacity\",e)}readOpacity(e,r){const i=r.layerDefinition;return 1-.01*(null!=i.transparency?i.transparency:i.drawingInfo.transparency)}writeOpacity(e,r,i,t){r.layerDefinition={drawingInfo:{transparency:100-100*e}}}writeParent(e,r){this.parent&&this.parent!==this.layer?r.parentLayerId=I(this.parent.id):r.parentLayerId=-1}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(e){if(e)for(const r of e.getSymbols())if(s(r)){$.warn(\"Sublayer renderer should use 2D symbols\");break}this._setAndNotifyLayer(\"renderer\",e)}get source(){return this._get(\"source\")||new E({mapLayerId:this.id})}set source(e){this._setAndNotifyLayer(\"source\",e)}set sublayers(e){this._handleSublayersChange(e,this._get(\"sublayers\")),this._set(\"sublayers\",e)}castSublayers(e){return w(a.ofType(V),e)}writeSublayers(e,r,i){this.get(\"sublayers.length\")&&(r[i]=this.sublayers.map((e=>e.id)).toArray().reverse())}readTypeIdField(e,r){let i=(r=r.layerDefinition||r).typeIdField;if(i&&r.fields){i=i.toLowerCase();const e=r.fields.find((e=>e.name.toLowerCase()===i));e&&(i=e.name)}return null}get url(){var e,r;const i=null!=(e=null==(r=this.layer)?void 0:r.parsedUrl)?e:this._lastParsedUrl,t=this.source;if(!i)return null;if(this._lastParsedUrl=i,\"map-layer\"===(null==t?void 0:t.type))return`${i.path}/${t.mapLayerId}`;const o={layer:JSON.stringify({source:this.source})};return`${i.path}/dynamicLayer?${f(o)}`}set url(e){e?this._override(\"url\",e):this._clearOverride(\"url\")}set visible(e){this._setAndNotifyLayer(\"visible\",e)}writeVisible(e,r,i,t){r[i]=this.getAtOrigin(\"defaultVisibility\",\"service\")||e}clone(){const{store:e}=h(this),r=new V;return h(r).store=e.clone(R),this.commitProperty(\"url\"),r._lastParsedUrl=this._lastParsedUrl,r}createPopupTemplate(e){return N(this,e)}createQuery(){return new M({returnGeometry:!0,where:this.definitionExpression||\"1=1\"})}async createFeatureLayer(){var e,r;if(this.hasOwnProperty(\"sublayers\"))return null;const i=null==(e=this.layer)?void 0:e.parsedUrl,t=new(0,(await import(\"../FeatureLayer.js\")).default)({url:i.path});return i&&this.source&&(\"map-layer\"===this.source.type?t.layerId=this.source.mapLayerId:t.dynamicDataSource=this.source),null!=this.layer.refreshInterval&&(t.refreshInterval=this.layer.refreshInterval),this.definitionExpression&&(t.definitionExpression=this.definitionExpression),this.originIdOf(\"labelingInfo\")>2&&(t.labelingInfo=y(this.labelingInfo)),this.originIdOf(\"labelsVisible\")>0&&(t.labelsVisible=this.labelsVisible),this.originIdOf(\"legendEnabled\")>0&&(t.legendEnabled=this.legendEnabled),this.originIdOf(\"visible\")>0&&(t.visible=this.visible),this.originIdOf(\"minScale\")>0&&(t.minScale=this.minScale),this.originIdOf(\"maxScale\")>0&&(t.maxScale=this.maxScale),this.originIdOf(\"opacity\")>0&&(t.opacity=this.opacity),this.originIdOf(\"popupTemplate\")>0&&(t.popupTemplate=y(this.popupTemplate)),this.originIdOf(\"renderer\")>2&&(t.renderer=y(this.renderer)),\"data-layer\"===(null==(r=this.source)?void 0:r.type)&&(t.dynamicDataSource=this.source.clone()),this.originIdOf(\"title\")>0&&(t.title=this.title),\"map-image\"===this.layer.type&&this.layer.originIdOf(\"customParameters\")>0&&(t.customParameters=this.layer.customParameters),\"tile\"===this.layer.type&&this.layer.originIdOf(\"customParameters\")>0&&(t.customParameters=this.layer.customParameters),t}getFeatureType(e){const{typeIdField:r,types:i}=this;if(!r||!e)return null;const t=e.attributes?e.attributes[r]:void 0;if(null==t)return null;let o=null;return i.some((e=>{const{id:r}=e;return null!=r&&(r.toString()===t.toString()&&(o=e),!!o)})),o}getFieldDomain(e,r){const i=r&&r.feature,t=this.getFeatureType(i);if(t){const r=t.domains&&t.domains[e];if(r&&\"inherited\"!==r.type)return r}return this._getLayerDomain(e)}async queryFeatures(e=this.createQuery(),r){var i,t,o,s;if(await this.load(),!this.get(\"capabilities.operations.supportsQuery\"))throw new l(\"Sublayer.queryFeatures\",\"this layer doesn't support queries.\");const[{executeQuery:a},{default:n}]=await Promise.all([import(\"../../rest/query/operations/query.js\"),import(\"../../rest/support/FeatureSet.js\")]),p=await a(this.url,M.from(e),null!=(i=null==(t=this.layer)?void 0:t.spatialReference)?i:null,{...r,query:{...null==(o=this.layer)?void 0:o.customParameters,token:null==(s=this.layer)?void 0:s.apiKey}}),y=n.fromJSON(p.data);if(null!=y&&y.features)for(const l of y.features)l.sourceLayer=this;return y}toExportImageJSON(){var e;const r={id:this.id,source:(null==(e=this.source)?void 0:e.toJSON())||{mapLayerId:this.id,type:\"mapLayer\"}};this.definitionExpression&&(r.definitionExpression=this.definitionExpression);const i=[\"renderer\",\"labelingInfo\",\"opacity\",\"labelsVisible\"].reduce(((e,r)=>(e[r]=this.originIdOf(r),e)),{});if(Object.keys(i).some((e=>i[e]>2))){const e=r.drawingInfo={};i.renderer>2&&(e.renderer=this.renderer?this.renderer.toJSON():null),i.labelsVisible>2&&(e.showLabels=this.labelsVisible),this.labelsVisible&&i.labelingInfo>2&&(e.labelingInfo=this.labelingInfo?this.labelingInfo.map((e=>e.write({},{origin:\"service\",layer:this.layer}))):null,e.showLabels=!0),i.opacity>2&&(e.transparency=100-100*this.opacity),this._assignDefaultSymbolColors(e.renderer)}return r}_assignDefaultSymbolColors(e){this._forEachSimpleMarkerSymbols(e,(e=>{e.color||\"esriSMSX\"!==e.style&&\"esriSMSCross\"!==e.style||(e.outline&&e.outline.color?e.color=e.outline.color:e.color=[0,0,0,0])}))}_forEachSimpleMarkerSymbols(e,r){if(e){const i=\"uniqueValueInfos\"in e?e.uniqueValueInfos:\"classBreakInfos\"in e?e.classBreakInfos:[];for(const e of i)k(e.symbol)&&r(e.symbol);\"symbol\"in e&&k(e.symbol)&&r(e.symbol),\"defaultSymbol\"in e&&k(e.defaultSymbol)&&r(e.defaultSymbol)}}_setAndNotifyLayer(e,r){const i=this.layer,t=this._get(e);let o,s;switch(e){case\"definitionExpression\":o=\"supportsSublayerDefinitionExpression\";case\"minScale\":case\"maxScale\":case\"visible\":o=\"supportsSublayerVisibility\";break;case\"labelingInfo\":case\"labelsVisible\":case\"opacity\":case\"renderer\":case\"source\":o=\"supportsDynamicLayers\",s=\"supportsModification\"}const a=h(this).getDefaultOrigin();if(\"service\"!==a){if(o&&!1===this.get(`layer.capabilities.exportMap.${o}`))return void this._logLockedError(e,`capability not available 'layer.capabilities.exportMap.${o}'`);if(s&&!1===this.get(`capabilities.exportMap.${s}`))return void this._logLockedError(e,`capability not available 'capabilities.exportMap.${s}'`)}\"source\"!==e||\"not-loaded\"===this.loadStatus?(this._set(e,r),\"service\"!==a&&t!==r&&i&&i.emit&&i.emit(\"sublayer-update\",{propertyName:e,target:this})):this._logLockedError(e,\"'source' can't be changed after calling sublayer.load()\")}_handleSublayersChange(e,r){r&&(r.forEach((e=>{e.parent=null,e.layer=null})),this.handles.removeAll()),e&&(e.forEach((e=>{e.parent=this,e.layer=this.layer})),this.handles.add([e.on(\"after-add\",(({item:e})=>{e.parent=this,e.layer=this.layer})),e.on(\"after-remove\",(({item:e})=>{e.parent=null,e.layer=null})),e.on(\"before-changes\",(e=>{const r=this.get(\"layer.capabilities.exportMap.supportsSublayersChanges\");null==r||r||($.error(new l(\"sublayer:sublayers-non-modifiable\",\"Sublayer can't be added, moved, or removed from the layer's sublayers\",{sublayer:this,layer:this.layer})),e.preventDefault())}))]))}_logLockedError(e,r){$.error(new l(\"sublayer:locked\",`Property '${e}' can't be changed on Sublayer from the layer '${this.layer.id}'`,{reason:r,sublayer:this,layer:this.layer}))}_getLayerDomain(e){const r=this.fieldsIndex.get(e);return r?r.domain:null}};B.test={isMapImageLayerOverridePolicy:e=>e===q||e===C,isTileImageLayerOverridePolicy:e=>e===A},e([m({readOnly:!0})],B.prototype,\"capabilities\",void 0),e([g(\"service\",\"capabilities\",[\"layerDefinition.canModifyLayer\",\"layerDefinition.capabilities\"])],B.prototype,\"readCapabilities\",null),e([m({type:String,value:null,json:{name:\"layerDefinition.definitionExpression\",write:{overridePolicy:C}}})],B.prototype,\"definitionExpression\",null),e([m({type:[x],json:{origins:{service:{read:{source:\"layerDefinition.fields\"}}}}})],B.prototype,\"fields\",void 0),e([m({readOnly:!0})],B.prototype,\"fieldsIndex\",null),e([m({type:T,json:{read:{source:\"layerDefinition.extent\"}}})],B.prototype,\"fullExtent\",void 0),e([m({type:String})],B.prototype,\"globalIdField\",void 0),e([g(\"service\",\"globalIdField\",[\"layerDefinition.globalIdField\",\"layerDefinition.fields\"])],B.prototype,\"readGlobalIdFieldFromService\",null),e([m({type:j,json:{write:{ignoreOrigin:!0}}})],B.prototype,\"id\",null),e([m({value:null,type:[F],json:{read:{source:\"layerDefinition.drawingInfo.labelingInfo\"},write:{target:\"layerDefinition.drawingInfo.labelingInfo\",overridePolicy:q}}})],B.prototype,\"labelingInfo\",null),e([S(\"labelingInfo\")],B.prototype,\"writeLabelingInfo\",null),e([m({type:Boolean,value:!0,json:{read:{source:\"layerDefinition.drawingInfo.showLabels\"},write:{target:\"layerDefinition.drawingInfo.showLabels\",overridePolicy:q}}})],B.prototype,\"labelsVisible\",null),e([m({value:null})],B.prototype,\"layer\",null),e([m({type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},read:{source:\"showLegend\"},write:{target:\"showLegend\",overridePolicy:U}}})],B.prototype,\"legendEnabled\",void 0),e([m({type:[\"show\",\"hide\",\"hide-children\"],value:\"show\",json:{read:!1,write:!1,origins:{\"web-scene\":{read:!0,write:!0}}}})],B.prototype,\"listMode\",null),e([m({type:Number,value:0,json:{write:{overridePolicy:q}}})],B.prototype,\"minScale\",null),e([g(\"minScale\",[\"minScale\",\"layerDefinition.minScale\"])],B.prototype,\"readMinScale\",null),e([m({type:Number,value:0,json:{write:{overridePolicy:q}}})],B.prototype,\"maxScale\",null),e([g(\"maxScale\",[\"maxScale\",\"layerDefinition.maxScale\"])],B.prototype,\"readMaxScale\",null),e([m({type:String})],B.prototype,\"objectIdField\",void 0),e([g(\"service\",\"objectIdField\",[\"layerDefinition.objectIdField\",\"layerDefinition.fields\"])],B.prototype,\"readObjectIdFieldFromService\",null),e([m({type:Number,value:1,json:{write:{target:\"layerDefinition.drawingInfo.transparency\",overridePolicy:q}}})],B.prototype,\"opacity\",null),e([g(\"opacity\",[\"layerDefinition.drawingInfo.transparency\",\"layerDefinition.transparency\"])],B.prototype,\"readOpacity\",null),e([S(\"opacity\")],B.prototype,\"writeOpacity\",null),e([m({json:{type:j,write:{target:\"parentLayerId\",allowNull:!0,overridePolicy:q}}})],B.prototype,\"parent\",void 0),e([S(\"parent\")],B.prototype,\"writeParent\",null),e([m({type:Boolean,value:!0,json:{read:{source:\"disablePopup\",reader:(e,r)=>!r.disablePopup},write:{target:\"disablePopup\",overridePolicy:U,writer(e,r,i){r[i]=!e}}}})],B.prototype,\"popupEnabled\",void 0),e([m({type:r,json:{read:{source:\"popupInfo\"},write:{target:\"popupInfo\",overridePolicy:U}}})],B.prototype,\"popupTemplate\",void 0),e([m({readOnly:!0})],B.prototype,\"defaultPopupTemplate\",null),e([m({types:i,value:null,json:{name:\"layerDefinition.drawingInfo.renderer\",write:{overridePolicy:q},origins:{\"web-scene\":{types:t,name:\"layerDefinition.drawingInfo.renderer\",write:{overridePolicy:q}}}}})],B.prototype,\"renderer\",null),e([m({types:{key:\"type\",base:null,typeMap:{\"data-layer\":_,\"map-layer\":E}},cast(e){if(e){if(\"mapLayerId\"in e)return L(E,e);if(\"dataSource\"in e)return L(_,e)}return e},json:{name:\"layerDefinition.source\",write:{overridePolicy:q}}})],B.prototype,\"source\",null),e([m()],B.prototype,\"sourceJSON\",void 0),e([m({value:null,json:{type:[j],write:{target:\"subLayerIds\",allowNull:!0,overridePolicy:q}}})],B.prototype,\"sublayers\",null),e([b(\"sublayers\")],B.prototype,\"castSublayers\",null),e([S(\"sublayers\")],B.prototype,\"writeSublayers\",null),e([m({type:String,json:{read:{source:\"name\"},write:{target:\"name\",allowNull:!0,overridePolicy:U}}})],B.prototype,\"title\",void 0),e([m({type:String})],B.prototype,\"typeIdField\",void 0),e([g(\"typeIdField\",[\"layerDefinition.typeIdField\"])],B.prototype,\"readTypeIdField\",null),e([m({type:[O],json:{origins:{service:{read:{source:\"layerDefinition.types\"}}}}})],B.prototype,\"types\",void 0),e([m({type:String,json:{read:{source:\"layerUrl\"},write:{target:\"layerUrl\",overridePolicy:A}}})],B.prototype,\"url\",null),e([m({type:Boolean,value:!0,json:{read:{source:\"defaultVisibility\"},write:{target:\"defaultVisibility\",overridePolicy:q}}})],B.prototype,\"visible\",null),e([S(\"visible\")],B.prototype,\"writeVisible\",null),B=V=e([v(\"esri.layers.support.Sublayer\")],B);var Q=B;export default Q;\n"],"sourceRoot":""}